OTP.sms = select Top 1 * from AUTH.dbo.otplog where subscriptionApplicationID = '%s' and channelID = 1 order by createdOn desc
OTP.email = select Top 1 * from AUTH.dbo.otplog where subscriptionApplicationID = '%s' and channelID = 2 order by createdOn desc
Activation.URL = select ActivationURL from AUTH..SubscriptionApplication where id = '%s'
delete.query =DECLARE @NTN NVARCHAR(50);SET @NTN ='%s'; DELETE FROM UPS.DBO.BillLineItem WHERE BillID IN (SELECT id FROM UPS.DBO.Bill WHERE BillToPartyNTN = @NTN); DELETE FROM UPS.DBO.Bill WHERE BillToPartyNTN = @NTN; DELETE FROM FILENEST.dbo.[File] WHERE id IN ( SELECT AttachedDocumentID FROM OGA.DBO.Attachment WHERE ownerdocumentid IN ( SELECT id FROM OGA.DBO.AgencyBusinessRegistration WHERE subscriptionid IN ( SELECT id FROM AUTH.DBO.subscription WHERE subscriptionApplicationID IN ( SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN ) ) ) ); DELETE FROM OGA.DBO.Attachment WHERE ownerdocumentid IN ( SELECT id FROM OGA.DBO.AgencyBusinessRegistration WHERE subscriptionid IN ( SELECT id FROM AUTH.DBO.subscription WHERE subscriptionApplicationID IN ( SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN ) ) ); DELETE FROM auth.dbo.[NADRAMessageLog] WHERE SubscriptionApplicationID IN ( SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN ); DELETE FROM auth.dbo.OTPLog WHERE SubscriptionApplicationID IN ( SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN ); DELETE FROM AUTH.DBO.[Subscription] WHERE NTN = @NTN; DELETE FROM AUTH.DBO.SubscriptionApplication WHERE NTN = @NTN;
delete.records=DECLARE @NTN NVARCHAR(50); SET @NTN = '%s'; DELETE FROM FILENEST.dbo.[File] WHERE id IN (SELECT AttachedDocumentID FROM OGA.DBO.Attachment WHERE ownerdocumentid IN (SELECT id FROM OGA.DBO.AgencyBusinessRegistration WHERE subscriptionid IN (SELECT id FROM AUTH.DBO.subscription WHERE subscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN)))); DELETE FROM OGA.DBO.Attachment WHERE ownerdocumentid IN (SELECT id FROM OGA.DBO.AgencyBusinessRegistration WHERE subscriptionid IN (SELECT id FROM AUTH.DBO.subscription WHERE subscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN))); DELETE FROM auth.dbo.[NADRAMessageLog] WHERE SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN); DELETE FROM auth.dbo.OTPLog WHERE SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN); DELETE FROM AUTH.DBO.AuthorizedAgent WHERE TraderNTN = @NTN OR AgentNTN = @NTN; DELETE FROM oga.dbo.RegistrationElementDataJson WHERE OwnerDocumentID IN (SELECT abr.ID FROM oga.dbo.AgencyBusinessRegistration AS abr WHERE abr.BusinessID IN (SELECT o.ID FROM auth.dbo.Organization AS o WHERE o.SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN))); DELETE FROM oga.dbo.AgencyBusinessRegistration WHERE BusinessID IN (SELECT o.ID FROM auth.dbo.Organization AS o WHERE o.SubscriptionApplicationID IN ((SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN))); DELETE FROM auth.dbo.OrganizationAddress WHERE OrganizationID IN (SELECT o.ID FROM auth.dbo.Organization AS o WHERE o.SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN)); DELETE FROM auth.dbo.Director WHERE OrganizationID IN (SELECT o.ID FROM auth.dbo.Organization AS o WHERE o.SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN)); DELETE FROM auth.dbo.Organization WHERE SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN); DELETE FROM AUTH.DBO.UserRole WHERE AspNetUserID IN (SELECT ANU.ID FROM auth.dbo.AspNetUser AS anu WHERE anu.RefDocumentID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN)); DECLARE @AspNetID BIGINT; SET @AspNetID = (SELECT ID FROM auth.dbo.AspNetUser WHERE RefDocumentID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN)); DELETE FROM auth.dbo.UserMenu WHERE AspNetUserID = @AspNetID; DELETE FROM auth.dbo.AspNetUser WHERE RefDocumentID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN); DELETE FROM AUTH.DBO.[Subscription] WHERE SubscriptionApplicationID IN (SELECT sa.ID FROM AUTH.DBO.SubscriptionApplication AS sa WHERE sa.NTN = @NTN); DELETE FROM auth.dbo.SubscriptionApplication WHERE NTN = @NTN; DELETE FROM auth.dbo.SubscriptionApplicationDetail WHERE SubscriptionApplicationID IN (SELECT auth.dbo.SubscriptionApplication.ID FROM auth.dbo.SubscriptionApplication WHERE NTN = @NTN);
PSID.Date.Update=update UPS..bill SET ExpiryDate=GetDate()-1  where BillDocumentNumber='%s'
Verification.Flag=SELECT VerificationFlag from AUTH..SubscriptionApplication where NTN='%s'
Officer.Username=select UserName from auth..AspNetUser where id =(select top 1 AspNetUserID from auth..UserDocumentAssignmentHistory where DocumentID = (select id from oga..ImportPermit where RequestDocumentNumber = '%s') order by UpdatedOn desc)
